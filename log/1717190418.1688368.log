2024-05-31 22:20:18,168 - root - INFO - Namespace(data='wikipedia', bs=200, prefix='tgn-attn', n_degree=10, n_head=2, n_epoch=50, n_layer=1, lr=0.0001, patience=5, n_runs=10, drop_out=0.1, gpu=0, node_dim=100, time_dim=100, backprop_every=1, use_memory=True, embedding_module='graph_attention', message_function='identity', memory_updater='gru', aggregator='last', memory_update_at_end=False, message_dim=100, memory_dim=172, different_new_nodes=False, uniform=False, randomize_features=False, use_destination_embedding_in_message=False, use_source_embedding_in_message=False, dyrep=False, use_position=True, position_embedding_dim=100)
2024-05-31 22:20:23,654 - root - INFO - num of training instances: 81029
2024-05-31 22:20:23,655 - root - INFO - num of batches per epoch: 406
2024-05-31 22:20:23,657 - root - INFO - start 0 epoch
2024-05-31 22:21:15,889 - root - INFO - epoch: 0 took 52.23s
2024-05-31 22:21:15,889 - root - INFO - Epoch mean loss: 0.7301644076561106
2024-05-31 22:21:15,890 - root - INFO - val auc: 0.9361487271098917, new node val auc: 0.9416038934426229
2024-05-31 22:21:15,890 - root - INFO - val ap: 0.9353305458939936, new node val ap: 0.9421890140081515
2024-05-31 22:21:15,966 - root - INFO - start 1 epoch
2024-05-31 22:22:13,259 - root - INFO - epoch: 1 took 57.34s
2024-05-31 22:22:13,259 - root - INFO - Epoch mean loss: 0.5496803489811902
2024-05-31 22:22:13,259 - root - INFO - val auc: 0.9566009527620573, new node val auc: 0.9559348360655737
2024-05-31 22:22:13,259 - root - INFO - val ap: 0.9587706592141564, new node val ap: 0.9569874176079859
2024-05-31 22:22:13,338 - root - INFO - start 2 epoch
2024-05-31 22:23:12,300 - root - INFO - epoch: 2 took 59.01s
2024-05-31 22:23:12,301 - root - INFO - Epoch mean loss: 0.4913079139634306
2024-05-31 22:23:12,301 - root - INFO - val auc: 0.9648492782827417, new node val auc: 0.9582840163934427
2024-05-31 22:23:12,301 - root - INFO - val ap: 0.966918866826933, new node val ap: 0.9606977826236388
2024-05-31 22:23:12,380 - root - INFO - start 3 epoch
2024-05-31 22:24:11,268 - root - INFO - epoch: 3 took 58.94s
2024-05-31 22:24:11,268 - root - INFO - Epoch mean loss: 0.43680870529319266
2024-05-31 22:24:11,268 - root - INFO - val auc: 0.9717603336572724, new node val auc: 0.9653189549180328
2024-05-31 22:24:11,268 - root - INFO - val ap: 0.9735495898332813, new node val ap: 0.9681822866186348
2024-05-31 22:24:11,359 - root - INFO - start 4 epoch
2024-05-31 22:25:10,452 - root - INFO - epoch: 4 took 59.15s
2024-05-31 22:25:10,452 - root - INFO - Epoch mean loss: 0.3912014147184165
2024-05-31 22:25:10,452 - root - INFO - val auc: 0.9767013624497417, new node val auc: 0.9710804303278688
2024-05-31 22:25:10,452 - root - INFO - val ap: 0.978083608908623, new node val ap: 0.9733200111263632
2024-05-31 22:25:10,533 - root - INFO - start 5 epoch
2024-05-31 22:26:10,189 - root - INFO - epoch: 5 took 59.71s
2024-05-31 22:26:10,189 - root - INFO - Epoch mean loss: 0.3609960407679304
2024-05-31 22:26:10,189 - root - INFO - val auc: 0.979081279654719, new node val auc: 0.9734997950819673
2024-05-31 22:26:10,189 - root - INFO - val ap: 0.9802921443630084, new node val ap: 0.9757729301986768
2024-05-31 22:26:10,273 - root - INFO - start 6 epoch
2024-05-31 22:27:10,205 - root - INFO - epoch: 6 took 59.99s
2024-05-31 22:27:10,205 - root - INFO - Epoch mean loss: 0.3487887261022488
2024-05-31 22:27:10,205 - root - INFO - val auc: 0.9794577502429543, new node val auc: 0.9744746926229509
2024-05-31 22:27:10,205 - root - INFO - val ap: 0.9804561983049154, new node val ap: 0.9766625503291791
2024-05-31 22:27:10,291 - root - INFO - start 7 epoch
2024-05-31 22:28:10,402 - root - INFO - epoch: 7 took 60.17s
2024-05-31 22:28:10,403 - root - INFO - Epoch mean loss: 0.33843333105295165
2024-05-31 22:28:10,403 - root - INFO - val auc: 0.9804718882791212, new node val auc: 0.9753101434426229
2024-05-31 22:28:10,403 - root - INFO - val ap: 0.9816188079846729, new node val ap: 0.977309173429821
2024-05-31 22:28:10,488 - root - INFO - start 8 epoch
2024-05-31 22:29:10,887 - root - INFO - epoch: 8 took 60.46s
2024-05-31 22:29:10,888 - root - INFO - Epoch mean loss: 0.3313630519095313
2024-05-31 22:29:10,888 - root - INFO - val auc: 0.981092204024467, new node val auc: 0.9762629098360656
2024-05-31 22:29:10,888 - root - INFO - val ap: 0.9822358111528987, new node val ap: 0.9785096749335368
2024-05-31 22:29:10,973 - root - INFO - start 9 epoch
2024-05-31 22:30:11,436 - root - INFO - epoch: 9 took 60.52s
2024-05-31 22:30:11,436 - root - INFO - Epoch mean loss: 0.3171774808849607
2024-05-31 22:30:11,436 - root - INFO - val auc: 0.981957727376665, new node val auc: 0.9766301229508196
2024-05-31 22:30:11,436 - root - INFO - val ap: 0.9829734657392519, new node val ap: 0.9786370074356991
2024-05-31 22:30:11,551 - root - INFO - start 10 epoch
2024-05-31 22:31:12,877 - root - INFO - epoch: 10 took 61.42s
2024-05-31 22:31:12,877 - root - INFO - Epoch mean loss: 0.3149270567253893
2024-05-31 22:31:12,877 - root - INFO - val auc: 0.9825068246346157, new node val auc: 0.9777254098360656
2024-05-31 22:31:12,877 - root - INFO - val ap: 0.9834290498714834, new node val ap: 0.979394732338533
2024-05-31 22:31:12,960 - root - INFO - start 11 epoch
2024-05-31 22:32:13,752 - root - INFO - epoch: 11 took 60.85s
2024-05-31 22:32:13,752 - root - INFO - Epoch mean loss: 0.30494763309438827
2024-05-31 22:32:13,752 - root - INFO - val auc: 0.9823794513043315, new node val auc: 0.977990368852459
2024-05-31 22:32:13,752 - root - INFO - val ap: 0.9831435534178699, new node val ap: 0.9800073888492051
2024-05-31 22:32:13,838 - root - INFO - start 12 epoch
2024-05-31 22:33:14,741 - root - INFO - epoch: 12 took 60.96s
2024-05-31 22:33:14,742 - root - INFO - Epoch mean loss: 0.30305968713143777
2024-05-31 22:33:14,742 - root - INFO - val auc: 0.9837925191505174, new node val auc: 0.9792297131147542
2024-05-31 22:33:14,742 - root - INFO - val ap: 0.9846352711307238, new node val ap: 0.981105122286895
2024-05-31 22:33:14,827 - root - INFO - start 13 epoch
2024-05-31 22:34:16,035 - root - INFO - epoch: 13 took 61.27s
2024-05-31 22:34:16,036 - root - INFO - Epoch mean loss: 0.29842547565845434
2024-05-31 22:34:16,036 - root - INFO - val auc: 0.9834661536042989, new node val auc: 0.9792227459016394
2024-05-31 22:34:16,036 - root - INFO - val ap: 0.9842637308975157, new node val ap: 0.9809782744467487
2024-05-31 22:34:16,122 - root - INFO - start 14 epoch
2024-05-31 22:35:17,337 - root - INFO - epoch: 14 took 61.28s
2024-05-31 22:35:17,338 - root - INFO - Epoch mean loss: 0.2915432328183956
2024-05-31 22:35:17,338 - root - INFO - val auc: 0.9833108390975439, new node val auc: 0.9795019467213114
2024-05-31 22:35:17,338 - root - INFO - val ap: 0.9840134254968883, new node val ap: 0.9814321179045171
2024-05-31 22:35:17,424 - root - INFO - start 15 epoch
2024-05-31 22:36:18,491 - root - INFO - epoch: 15 took 61.13s
2024-05-31 22:36:18,491 - root - INFO - Epoch mean loss: 0.2837908961099063
2024-05-31 22:36:18,491 - root - INFO - val auc: 0.9833733588673566, new node val auc: 0.979191393442623
2024-05-31 22:36:18,492 - root - INFO - val ap: 0.9842902406992657, new node val ap: 0.9812621145220614
2024-05-31 22:36:18,577 - root - INFO - start 16 epoch
2024-05-31 22:37:19,710 - root - INFO - epoch: 16 took 61.19s
2024-05-31 22:37:19,710 - root - INFO - Epoch mean loss: 0.27951815816128783
2024-05-31 22:37:19,710 - root - INFO - val auc: 0.9832616565673888, new node val auc: 0.9794812499999999
2024-05-31 22:37:19,710 - root - INFO - val ap: 0.9835862116080726, new node val ap: 0.9803655405945653
2024-05-31 22:37:19,796 - root - INFO - start 17 epoch
2024-05-31 22:38:21,289 - root - INFO - epoch: 17 took 61.55s
2024-05-31 22:38:21,289 - root - INFO - Epoch mean loss: 0.276641863980904
2024-05-31 22:38:21,289 - root - INFO - val auc: 0.9840576649707503, new node val auc: 0.9799238729508197
2024-05-31 22:38:21,289 - root - INFO - val ap: 0.9848972932315485, new node val ap: 0.9816165089495106
2024-05-31 22:38:21,374 - root - INFO - start 18 epoch
2024-05-31 22:39:23,813 - root - INFO - epoch: 18 took 62.50s
2024-05-31 22:39:23,814 - root - INFO - Epoch mean loss: 0.2706112240629243
2024-05-31 22:39:23,814 - root - INFO - val auc: 0.9844604813353912, new node val auc: 0.9806144467213114
2024-05-31 22:39:23,814 - root - INFO - val ap: 0.985039336955166, new node val ap: 0.9822833130167155
2024-05-31 22:39:23,897 - root - INFO - start 19 epoch
2024-05-31 22:40:25,919 - root - INFO - epoch: 19 took 62.08s
2024-05-31 22:40:25,920 - root - INFO - Epoch mean loss: 0.26304519536166354
2024-05-31 22:40:25,920 - root - INFO - val auc: 0.9842690947807696, new node val auc: 0.9812420081967214
2024-05-31 22:40:25,920 - root - INFO - val ap: 0.9850743182434945, new node val ap: 0.9828743408880487
2024-05-31 22:40:26,005 - root - INFO - start 20 epoch
2024-05-31 22:41:28,407 - root - INFO - epoch: 20 took 62.46s
2024-05-31 22:41:28,408 - root - INFO - Epoch mean loss: 0.2627097313553829
2024-05-31 22:41:28,408 - root - INFO - val auc: 0.9850133174698451, new node val auc: 0.9815641393442623
2024-05-31 22:41:28,408 - root - INFO - val ap: 0.9858539699750685, new node val ap: 0.9831259363640511
2024-05-31 22:41:28,502 - root - INFO - start 21 epoch
2024-05-31 22:42:30,714 - root - INFO - epoch: 21 took 62.28s
2024-05-31 22:42:30,714 - root - INFO - Epoch mean loss: 0.2536133636211233
2024-05-31 22:42:30,714 - root - INFO - val auc: 0.9849932544446351, new node val auc: 0.9816465163934427
2024-05-31 22:42:30,714 - root - INFO - val ap: 0.9856141693525526, new node val ap: 0.9832413316130735
2024-05-31 22:42:30,801 - root - INFO - start 22 epoch
2024-05-31 22:43:32,784 - root - INFO - epoch: 22 took 62.04s
2024-05-31 22:43:32,785 - root - INFO - Epoch mean loss: 0.25083464606128303
2024-05-31 22:43:32,785 - root - INFO - val auc: 0.9854824548867166, new node val auc: 0.9818702868852459
2024-05-31 22:43:32,785 - root - INFO - val ap: 0.9859772108398592, new node val ap: 0.9833458726555159
2024-05-31 22:43:32,871 - root - INFO - start 23 epoch
2024-05-31 22:44:34,856 - root - INFO - epoch: 23 took 62.05s
2024-05-31 22:44:34,856 - root - INFO - Epoch mean loss: 0.24412363951135738
2024-05-31 22:44:34,856 - root - INFO - val auc: 0.9854470359572399, new node val auc: 0.981830532786885
2024-05-31 22:44:34,856 - root - INFO - val ap: 0.9861439766542718, new node val ap: 0.9832840519706453
2024-05-31 22:44:34,944 - root - INFO - start 24 epoch
2024-05-31 22:45:36,798 - root - INFO - epoch: 24 took 61.91s
2024-05-31 22:45:36,798 - root - INFO - Epoch mean loss: 0.23922577643482557
2024-05-31 22:45:36,798 - root - INFO - val auc: 0.9847790082699747, new node val auc: 0.9809408811475411
2024-05-31 22:45:36,798 - root - INFO - val ap: 0.985600373242073, new node val ap: 0.9825293806573053
2024-05-31 22:45:36,883 - root - INFO - start 25 epoch
2024-05-31 22:46:39,295 - root - INFO - epoch: 25 took 62.47s
2024-05-31 22:46:39,295 - root - INFO - Epoch mean loss: 0.2428118010129541
2024-05-31 22:46:39,295 - root - INFO - val auc: 0.9848179590883972, new node val auc: 0.9811659836065574
2024-05-31 22:46:39,295 - root - INFO - val ap: 0.9855447134803902, new node val ap: 0.9824855629796839
2024-05-31 22:46:39,384 - root - INFO - start 26 epoch
2024-05-31 22:47:42,192 - root - INFO - epoch: 26 took 62.87s
2024-05-31 22:47:42,193 - root - INFO - Epoch mean loss: 0.2360294644395119
2024-05-31 22:47:42,193 - root - INFO - val auc: 0.9847955653690048, new node val auc: 0.9818444672131147
2024-05-31 22:47:42,193 - root - INFO - val ap: 0.9856756381983668, new node val ap: 0.9833201181123792
2024-05-31 22:47:42,281 - root - INFO - start 27 epoch
2024-05-31 22:48:44,504 - root - INFO - epoch: 27 took 62.28s
2024-05-31 22:48:44,504 - root - INFO - Epoch mean loss: 0.23375268478698918
2024-05-31 22:48:44,504 - root - INFO - val auc: 0.9848443048648031, new node val auc: 0.9812559426229509
2024-05-31 22:48:44,504 - root - INFO - val ap: 0.9857684505845736, new node val ap: 0.9828268452481569
2024-05-31 22:48:44,591 - root - INFO - start 28 epoch
2024-05-31 22:49:27,400 - root - ERROR - CUDA out of memory. Tried to allocate 2.00 MiB (GPU 0; 15.77 GiB total capacity; 14.46 GiB already allocated; 1.62 MiB free; 15.39 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
