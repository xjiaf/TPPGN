2024-06-02 19:29:21,661 - root - INFO - Namespace(data='wikipedia', bs=200, prefix='ptgn-attn', n_degree=10, n_head=4, n_epoch=50, n_layer=1, lr=0.0001, patience=5, n_runs=4, drop_out=0.2, gpu=0, node_dim=100, time_dim=100, backprop_every=1, use_memory=True, embedding_module='graph_attention', message_function='identity', memory_updater='gru', aggregator='last', memory_update_at_end=False, message_dim=100, memory_dim=172, different_new_nodes=False, uniform=False, randomize_features=False, use_destination_embedding_in_message=False, use_source_embedding_in_message=False, dyrep=False, use_position=True, position_embedding_dim=8)
2024-06-02 19:29:26,680 - root - INFO - num of training instances: 81029
2024-06-02 19:29:26,681 - root - INFO - num of batches per epoch: 406
2024-06-02 19:29:26,683 - root - INFO - start 0 epoch
2024-06-02 19:30:20,294 - root - INFO - epoch: 0 took 53.61s
2024-06-02 19:30:20,294 - root - INFO - Epoch mean loss: 0.6933253570436844
2024-06-02 19:30:20,294 - root - INFO - val auc: 0.9435797280817089, new node val auc: 0.9498181352459016
2024-06-02 19:30:20,294 - root - INFO - val ap: 0.9405336888706668, new node val ap: 0.9510410212881347
2024-06-02 19:30:20,365 - root - INFO - start 1 epoch
2024-06-02 19:31:21,485 - root - INFO - epoch: 1 took 61.17s
2024-06-02 19:31:21,486 - root - INFO - Epoch mean loss: 0.5421429108369527
2024-06-02 19:31:21,486 - root - INFO - val auc: 0.958940074124888, new node val auc: 0.9605326844262295
2024-06-02 19:31:21,486 - root - INFO - val ap: 0.9615068347977591, new node val ap: 0.9625680778933552
2024-06-02 19:31:21,559 - root - INFO - start 2 epoch
2024-06-02 19:32:23,134 - root - INFO - epoch: 2 took 61.62s
2024-06-02 19:32:23,134 - root - INFO - Epoch mean loss: 0.4656446636310352
2024-06-02 19:32:23,134 - root - INFO - val auc: 0.9655659768669373, new node val auc: 0.9638073770491803
2024-06-02 19:32:23,134 - root - INFO - val ap: 0.9673377042653766, new node val ap: 0.9660301685524019
2024-06-02 19:32:23,205 - root - INFO - start 3 epoch
2024-06-02 19:33:25,452 - root - INFO - epoch: 3 took 62.30s
2024-06-02 19:33:25,453 - root - INFO - Epoch mean loss: 0.4460764105977683
2024-06-02 19:33:25,453 - root - INFO - val auc: 0.9714393647935364, new node val auc: 0.9692099385245901
2024-06-02 19:33:25,453 - root - INFO - val ap: 0.9728683832161404, new node val ap: 0.9705054850459324
2024-06-02 19:33:25,526 - root - INFO - start 4 epoch
2024-06-02 19:34:27,549 - root - INFO - epoch: 4 took 62.07s
2024-06-02 19:34:27,549 - root - INFO - Epoch mean loss: 0.413867915168478
2024-06-02 19:34:27,549 - root - INFO - val auc: 0.9714392961946684, new node val auc: 0.9686406762295082
2024-06-02 19:34:27,549 - root - INFO - val ap: 0.9725053002705072, new node val ap: 0.9706870687848191
2024-06-02 19:34:27,624 - root - INFO - start 5 epoch
2024-06-02 19:35:28,878 - root - INFO - epoch: 5 took 61.31s
2024-06-02 19:35:28,879 - root - INFO - Epoch mean loss: 0.40676455992489613
2024-06-02 19:35:28,879 - root - INFO - val auc: 0.974163104289335, new node val auc: 0.9724139344262295
2024-06-02 19:35:28,879 - root - INFO - val ap: 0.974915027886978, new node val ap: 0.9739746562977192
2024-06-02 19:35:28,951 - root - INFO - start 6 epoch
2024-06-02 19:36:30,487 - root - INFO - epoch: 6 took 61.59s
2024-06-02 19:36:30,488 - root - INFO - Epoch mean loss: 0.40004246296553775
2024-06-02 19:36:30,488 - root - INFO - val auc: 0.9741457328169363, new node val auc: 0.9704658811475408
2024-06-02 19:36:30,488 - root - INFO - val ap: 0.9751399713475657, new node val ap: 0.9721047996133503
2024-06-02 19:36:30,561 - root - INFO - start 7 epoch
2024-06-02 19:37:32,188 - root - INFO - epoch: 7 took 61.68s
2024-06-02 19:37:32,189 - root - INFO - Epoch mean loss: 0.3867613670640978
2024-06-02 19:37:32,189 - root - INFO - val auc: 0.9750378317993866, new node val auc: 0.9716480532786885
2024-06-02 19:37:32,189 - root - INFO - val ap: 0.975523273762469, new node val ap: 0.9726109651387252
2024-06-02 19:37:32,309 - root - INFO - start 8 epoch
2024-06-02 19:38:26,866 - root - INFO - epoch: 8 took 54.64s
2024-06-02 19:38:26,866 - root - INFO - Epoch mean loss: 0.3755511888876337
2024-06-02 19:38:26,866 - root - INFO - val auc: 0.9778109212732713, new node val auc: 0.9740724385245901
2024-06-02 19:38:26,866 - root - INFO - val ap: 0.9789284421341723, new node val ap: 0.9757837213650806
2024-06-02 19:38:26,933 - root - INFO - start 9 epoch
2024-06-02 19:39:20,772 - root - INFO - epoch: 9 took 53.88s
2024-06-02 19:39:20,773 - root - INFO - Epoch mean loss: 0.36007028355680665
2024-06-02 19:39:20,773 - root - INFO - val auc: 0.9784328750547837, new node val auc: 0.9759300204918034
2024-06-02 19:39:20,773 - root - INFO - val ap: 0.9795017297189483, new node val ap: 0.9776107803068844
2024-06-02 19:39:20,869 - root - INFO - start 10 epoch
2024-06-02 19:40:20,702 - root - INFO - epoch: 10 took 59.90s
2024-06-02 19:40:20,704 - root - INFO - Epoch mean loss: 0.35352249986726075
2024-06-02 19:40:20,704 - root - INFO - val auc: 0.9809567560357476, new node val auc: 0.9776766393442623
2024-06-02 19:40:20,704 - root - INFO - val ap: 0.9819123366515944, new node val ap: 0.9789297927602234
2024-06-02 19:40:20,814 - root - INFO - start 11 epoch
2024-06-02 19:41:14,079 - root - INFO - epoch: 11 took 53.33s
2024-06-02 19:41:14,079 - root - INFO - Epoch mean loss: 0.3370158273745053
2024-06-02 19:41:14,080 - root - INFO - val auc: 0.9815878713390119, new node val auc: 0.9786512295081967
2024-06-02 19:41:14,080 - root - INFO - val ap: 0.9825515315543567, new node val ap: 0.9798122889524958
2024-06-02 19:41:14,148 - root - INFO - start 12 epoch
2024-06-02 19:42:07,541 - root - INFO - epoch: 12 took 53.44s
2024-06-02 19:42:07,541 - root - INFO - Epoch mean loss: 0.34231252138837803
2024-06-02 19:42:07,541 - root - INFO - val auc: 0.9823687370186167, new node val auc: 0.9779752049180326
2024-06-02 19:42:07,541 - root - INFO - val ap: 0.983321778977045, new node val ap: 0.9797499328016132
2024-06-02 19:42:07,610 - root - INFO - start 13 epoch
2024-06-02 19:43:00,695 - root - INFO - epoch: 13 took 53.13s
2024-06-02 19:43:00,695 - root - INFO - Epoch mean loss: 0.3298974733414321
2024-06-02 19:43:00,695 - root - INFO - val auc: 0.9826705425027152, new node val auc: 0.9800134221311472
2024-06-02 19:43:00,695 - root - INFO - val ap: 0.9836679680759215, new node val ap: 0.981647150087973
2024-06-02 19:43:00,789 - root - INFO - start 14 epoch
2024-06-02 19:43:54,891 - root - INFO - epoch: 14 took 54.17s
2024-06-02 19:43:54,892 - root - INFO - Epoch mean loss: 0.32643521646854323
2024-06-02 19:43:54,892 - root - INFO - val auc: 0.982611088721203, new node val auc: 0.9795962090163934
2024-06-02 19:43:54,892 - root - INFO - val ap: 0.9834646625454581, new node val ap: 0.981324435152138
2024-06-02 19:43:54,959 - root - INFO - start 15 epoch
2024-06-02 19:44:47,185 - root - INFO - epoch: 15 took 52.27s
2024-06-02 19:44:47,185 - root - INFO - Epoch mean loss: 0.32202002919953443
2024-06-02 19:44:47,186 - root - INFO - val auc: 0.9825989038472531, new node val auc: 0.9796627049180329
2024-06-02 19:44:47,186 - root - INFO - val ap: 0.9830681886246139, new node val ap: 0.9811384757487162
2024-06-02 19:44:47,252 - root - INFO - start 16 epoch
2024-06-02 19:45:41,694 - root - INFO - epoch: 16 took 54.49s
2024-06-02 19:45:41,694 - root - INFO - Epoch mean loss: 0.32109761847357443
2024-06-02 19:45:41,694 - root - INFO - val auc: 0.9826930610339374, new node val auc: 0.9798987704918033
2024-06-02 19:45:41,694 - root - INFO - val ap: 0.983250305034833, new node val ap: 0.9814592923947736
2024-06-02 19:45:41,761 - root - INFO - start 17 epoch
2024-06-02 19:46:35,397 - root - INFO - epoch: 17 took 53.68s
2024-06-02 19:46:35,397 - root - INFO - Epoch mean loss: 0.3182411998180039
2024-06-02 19:46:35,398 - root - INFO - val auc: 0.9827501810247908, new node val auc: 0.9802162909836065
2024-06-02 19:46:35,398 - root - INFO - val ap: 0.9835379687141679, new node val ap: 0.981609280751168
2024-06-02 19:46:35,500 - root - INFO - start 18 epoch
2024-06-02 19:47:29,554 - root - INFO - epoch: 18 took 54.14s
2024-06-02 19:47:29,555 - root - INFO - Epoch mean loss: 0.31441803346273345
2024-06-02 19:47:29,555 - root - INFO - val auc: 0.9827653528077894, new node val auc: 0.9809647540983607
2024-06-02 19:47:29,555 - root - INFO - val ap: 0.9836687652259587, new node val ap: 0.982480374043702
2024-06-02 19:47:29,647 - root - INFO - start 19 epoch
2024-06-02 19:48:23,109 - root - INFO - epoch: 19 took 53.53s
2024-06-02 19:48:23,110 - root - INFO - Epoch mean loss: 0.3061656757014726
2024-06-02 19:48:23,110 - root - INFO - val auc: 0.9841177490043638, new node val auc: 0.9807473360655737
2024-06-02 19:48:23,110 - root - INFO - val ap: 0.9848021890914509, new node val ap: 0.9819522927352249
2024-06-02 19:48:23,177 - root - INFO - start 20 epoch
2024-06-02 19:49:15,350 - root - INFO - epoch: 20 took 52.22s
2024-06-02 19:49:15,350 - root - INFO - Epoch mean loss: 0.31032764386807754
2024-06-02 19:49:15,350 - root - INFO - val auc: 0.984074386421235, new node val auc: 0.9802094262295082
2024-06-02 19:49:15,350 - root - INFO - val ap: 0.9846931900809381, new node val ap: 0.9817077769074061
2024-06-02 19:49:15,417 - root - INFO - start 21 epoch
2024-06-02 19:50:07,069 - root - INFO - epoch: 21 took 51.70s
2024-06-02 19:50:07,070 - root - INFO - Epoch mean loss: 0.3035448838043683
2024-06-02 19:50:07,070 - root - INFO - val auc: 0.9842547862001944, new node val auc: 0.9811703893442623
2024-06-02 19:50:07,070 - root - INFO - val ap: 0.9847965997248688, new node val ap: 0.9825386347269791
2024-06-02 19:50:07,137 - root - INFO - start 22 epoch
2024-06-02 19:50:58,861 - root - INFO - epoch: 22 took 51.77s
2024-06-02 19:50:58,862 - root - INFO - Epoch mean loss: 0.29858154007073107
2024-06-02 19:50:58,862 - root - INFO - val auc: 0.9843047009279904, new node val auc: 0.9806425204918032
2024-06-02 19:50:58,862 - root - INFO - val ap: 0.9849756017343163, new node val ap: 0.98216604989386
2024-06-02 19:50:58,925 - root - INFO - start 23 epoch
2024-06-02 19:51:49,209 - root - INFO - epoch: 23 took 50.33s
2024-06-02 19:51:49,210 - root - INFO - Epoch mean loss: 0.2978025051613747
2024-06-02 19:51:49,210 - root - INFO - val auc: 0.9841804559919207, new node val auc: 0.9807075819672133
2024-06-02 19:51:49,210 - root - INFO - val ap: 0.9847005369764611, new node val ap: 0.982092045751528
2024-06-02 19:51:49,272 - root - INFO - start 24 epoch
2024-06-02 19:52:40,185 - root - INFO - epoch: 24 took 50.95s
2024-06-02 19:52:40,185 - root - INFO - Epoch mean loss: 0.29502941627660995
2024-06-02 19:52:40,185 - root - INFO - val auc: 0.9850593061033937, new node val auc: 0.9822154713114755
2024-06-02 19:52:40,185 - root - INFO - val ap: 0.985555117927071, new node val ap: 0.9832687648041218
2024-06-02 19:52:40,249 - root - INFO - start 25 epoch
2024-06-02 19:53:31,135 - root - INFO - epoch: 25 took 50.93s
2024-06-02 19:53:31,136 - root - INFO - Epoch mean loss: 0.2930095851274547
2024-06-02 19:53:31,136 - root - INFO - val auc: 0.9849315292783782, new node val auc: 0.9825937499999999
2024-06-02 19:53:31,136 - root - INFO - val ap: 0.9854022666468539, new node val ap: 0.9838152870615017
2024-06-02 19:53:31,199 - root - INFO - start 26 epoch
2024-06-02 19:54:22,685 - root - INFO - epoch: 26 took 51.53s
2024-06-02 19:54:22,686 - root - INFO - Epoch mean loss: 0.28720219455329066
2024-06-02 19:54:22,686 - root - INFO - val auc: 0.984459509994474, new node val auc: 0.9815339139344261
2024-06-02 19:54:22,686 - root - INFO - val ap: 0.985034224689344, new node val ap: 0.9829954701956244
2024-06-02 19:54:22,750 - root - INFO - start 27 epoch
2024-06-02 19:55:12,775 - root - INFO - epoch: 27 took 50.07s
2024-06-02 19:55:12,775 - root - INFO - Epoch mean loss: 0.2911638521722385
2024-06-02 19:55:12,775 - root - INFO - val auc: 0.9848447052630576, new node val auc: 0.9810835040983606
2024-06-02 19:55:12,775 - root - INFO - val ap: 0.9855162716611496, new node val ap: 0.9819906770685027
2024-06-02 19:55:12,840 - root - INFO - start 28 epoch
2024-06-02 19:56:04,601 - root - INFO - epoch: 28 took 51.80s
2024-06-02 19:56:04,601 - root - INFO - Epoch mean loss: 0.2873006214025279
2024-06-02 19:56:04,601 - root - INFO - val auc: 0.9841485065454755, new node val auc: 0.9803766393442622
2024-06-02 19:56:04,601 - root - INFO - val ap: 0.9848820563331047, new node val ap: 0.982053410269659
2024-06-02 19:56:04,667 - root - INFO - start 29 epoch
2024-06-02 19:56:55,364 - root - INFO - epoch: 29 took 50.74s
2024-06-02 19:56:55,364 - root - INFO - Epoch mean loss: 0.2878052059726175
2024-06-02 19:56:55,364 - root - INFO - val auc: 0.9843169710741441, new node val auc: 0.9812203893442625
2024-06-02 19:56:55,364 - root - INFO - val ap: 0.9849294676040584, new node val ap: 0.9826913845891522
2024-06-02 19:56:55,364 - root - INFO - No improvement over 5 epochs, stop training
2024-06-02 19:56:55,364 - root - INFO - Loading the best model at epoch 24
2024-06-02 19:56:55,377 - root - INFO - Loaded the best model at epoch 24 for inference
2024-06-02 19:57:09,631 - root - INFO - Test statistics: Old nodes -- auc: 0.9823616794336782, ap: 0.9828375206392094
2024-06-02 19:57:09,631 - root - INFO - Test statistics: New nodes -- auc: 0.9749592839864151, ap: 0.9759960690838926
2024-06-02 19:57:09,631 - root - INFO - Saving TGN model
2024-06-02 19:57:09,914 - root - INFO - TGN model saved
2024-06-02 19:57:10,067 - root - INFO - num of training instances: 81029
2024-06-02 19:57:10,067 - root - INFO - num of batches per epoch: 406
2024-06-02 19:57:10,071 - root - INFO - start 0 epoch
2024-06-02 19:57:54,480 - root - INFO - epoch: 0 took 44.41s
2024-06-02 19:57:54,480 - root - INFO - Epoch mean loss: 0.6962710594015168
2024-06-02 19:57:54,480 - root - INFO - val auc: 0.9476969216257931, new node val auc: 0.9522859631147541
2024-06-02 19:57:54,480 - root - INFO - val ap: 0.9472953967544426, new node val ap: 0.9538335780973778
2024-06-02 19:57:54,543 - root - INFO - start 1 epoch
2024-06-02 19:58:45,155 - root - INFO - epoch: 1 took 50.65s
2024-06-02 19:58:45,155 - root - INFO - Epoch mean loss: 0.5379719521318164
2024-06-02 19:58:45,155 - root - INFO - val auc: 0.954898635644734, new node val auc: 0.9556237704918031
2024-06-02 19:58:45,155 - root - INFO - val ap: 0.9575659938177422, new node val ap: 0.958292590426028
2024-06-02 19:58:45,218 - root - INFO - start 2 epoch
2024-06-02 19:59:35,953 - root - INFO - epoch: 2 took 50.78s
2024-06-02 19:59:35,953 - root - INFO - Epoch mean loss: 0.4905782953785558
2024-06-02 19:59:35,954 - root - INFO - val auc: 0.9624208545322891, new node val auc: 0.9588982581967214
2024-06-02 19:59:35,954 - root - INFO - val ap: 0.9649289400519074, new node val ap: 0.9616462195388644
2024-06-02 19:59:36,016 - root - INFO - start 3 epoch
2024-06-02 20:00:24,628 - root - INFO - epoch: 3 took 48.65s
2024-06-02 20:00:24,628 - root - INFO - Epoch mean loss: 0.4555227732643705
2024-06-02 20:00:24,629 - root - INFO - val auc: 0.9684840898264069, new node val auc: 0.9670856557377049
2024-06-02 20:00:24,629 - root - INFO - val ap: 0.9704476160783615, new node val ap: 0.9696870634168355
2024-06-02 20:00:24,691 - root - INFO - start 4 epoch
2024-06-02 20:01:15,232 - root - INFO - epoch: 4 took 50.58s
2024-06-02 20:01:15,232 - root - INFO - Epoch mean loss: 0.43007069345325083
2024-06-02 20:01:15,233 - root - INFO - val auc: 0.9699485689513904, new node val auc: 0.9665768442622952
2024-06-02 20:01:15,233 - root - INFO - val ap: 0.9713810099803049, new node val ap: 0.9689880483291262
2024-06-02 20:01:15,297 - root - INFO - start 5 epoch
2024-06-02 20:02:05,523 - root - INFO - epoch: 5 took 50.27s
2024-06-02 20:02:05,523 - root - INFO - Epoch mean loss: 0.41247145479242203
2024-06-02 20:02:05,523 - root - INFO - val auc: 0.9720840502867816, new node val auc: 0.9693881147540984
2024-06-02 20:02:05,524 - root - INFO - val ap: 0.973272677122292, new node val ap: 0.9716284863995436
2024-06-02 20:02:05,588 - root - INFO - start 6 epoch
2024-06-02 20:02:55,813 - root - INFO - epoch: 6 took 50.27s
2024-06-02 20:02:55,813 - root - INFO - Epoch mean loss: 0.39809144042395606
2024-06-02 20:02:55,813 - root - INFO - val auc: 0.9742415509060768, new node val auc: 0.9708278688524591
2024-06-02 20:02:55,814 - root - INFO - val ap: 0.9752338418658376, new node val ap: 0.9729179214738413
2024-06-02 20:02:55,894 - root - INFO - start 7 epoch
2024-06-02 20:03:48,153 - root - INFO - epoch: 7 took 52.32s
2024-06-02 20:03:48,154 - root - INFO - Epoch mean loss: 0.38268471619325317
2024-06-02 20:03:48,154 - root - INFO - val auc: 0.9774254566112159, new node val auc: 0.9739251024590164
2024-06-02 20:03:48,154 - root - INFO - val ap: 0.9787955433526256, new node val ap: 0.9762317406491513
2024-06-02 20:03:48,220 - root - INFO - start 8 epoch
2024-06-02 20:04:38,993 - root - INFO - epoch: 8 took 50.82s
2024-06-02 20:04:38,994 - root - INFO - Epoch mean loss: 0.3668790690123741
2024-06-02 20:04:38,994 - root - INFO - val auc: 0.9786993697478991, new node val auc: 0.9754457991803279
2024-06-02 20:04:38,994 - root - INFO - val ap: 0.9800424768705982, new node val ap: 0.9776199062263655
2024-06-02 20:04:39,059 - root - INFO - start 9 epoch
2024-06-02 20:05:29,997 - root - INFO - epoch: 9 took 50.98s
2024-06-02 20:05:29,998 - root - INFO - Epoch mean loss: 0.3608148615128301
2024-06-02 20:05:29,998 - root - INFO - val auc: 0.9797296613883649, new node val auc: 0.9768575819672132
2024-06-02 20:05:29,998 - root - INFO - val ap: 0.9811138042383393, new node val ap: 0.9787224046657997
2024-06-02 20:05:30,097 - root - INFO - start 10 epoch
2024-06-02 20:06:21,027 - root - INFO - epoch: 10 took 51.01s
2024-06-02 20:06:21,027 - root - INFO - Epoch mean loss: 0.34981892507504947
2024-06-02 20:06:21,027 - root - INFO - val auc: 0.9810945773547515, new node val auc: 0.9769268442622949
2024-06-02 20:06:21,027 - root - INFO - val ap: 0.9821715756313948, new node val ap: 0.9788057994196954
2024-06-02 20:06:21,091 - root - INFO - start 11 epoch
2024-06-02 20:07:11,842 - root - INFO - epoch: 11 took 50.79s
2024-06-02 20:07:11,842 - root - INFO - Epoch mean loss: 0.34295929454523943
2024-06-02 20:07:11,842 - root - INFO - val auc: 0.9811155857581128, new node val auc: 0.9779172131147542
2024-06-02 20:07:11,842 - root - INFO - val ap: 0.9822890384873987, new node val ap: 0.9799548032975828
2024-06-02 20:07:11,907 - root - INFO - start 12 epoch
2024-06-02 20:08:02,067 - root - INFO - epoch: 12 took 50.20s
2024-06-02 20:08:02,067 - root - INFO - Epoch mean loss: 0.3320763038810838
2024-06-02 20:08:02,067 - root - INFO - val auc: 0.9810260670935043, new node val auc: 0.9778154713114754
2024-06-02 20:08:02,067 - root - INFO - val ap: 0.9821521937633861, new node val ap: 0.9796521957603119
2024-06-02 20:08:02,131 - root - INFO - start 13 epoch
2024-06-02 20:08:52,598 - root - INFO - epoch: 13 took 50.51s
2024-06-02 20:08:52,598 - root - INFO - Epoch mean loss: 0.3309795493305904
2024-06-02 20:08:52,598 - root - INFO - val auc: 0.9817897849616035, new node val auc: 0.9776722336065574
2024-06-02 20:08:52,598 - root - INFO - val ap: 0.9827335477177738, new node val ap: 0.9792346568752864
2024-06-02 20:08:52,662 - root - INFO - start 14 epoch
2024-06-02 20:09:44,080 - root - INFO - epoch: 14 took 51.46s
2024-06-02 20:09:44,080 - root - INFO - Epoch mean loss: 0.32471340333152876
2024-06-02 20:09:44,081 - root - INFO - val auc: 0.9836596181329674, new node val auc: 0.9797414959016394
2024-06-02 20:09:44,081 - root - INFO - val ap: 0.9845570157921364, new node val ap: 0.9814263600519717
2024-06-02 20:09:44,145 - root - INFO - start 15 epoch
2024-06-02 20:10:34,011 - root - INFO - epoch: 15 took 49.91s
2024-06-02 20:10:34,011 - root - INFO - Epoch mean loss: 0.31601376765467265
2024-06-02 20:10:34,011 - root - INFO - val auc: 0.9838708180891402, new node val auc: 0.9808706967213113
2024-06-02 20:10:34,011 - root - INFO - val ap: 0.9844583500260412, new node val ap: 0.9824435121782432
2024-06-02 20:10:34,075 - root - INFO - start 16 epoch
2024-06-02 20:11:26,268 - root - INFO - epoch: 16 took 52.23s
2024-06-02 20:11:26,269 - root - INFO - Epoch mean loss: 0.31615602052564107
2024-06-02 20:11:26,269 - root - INFO - val auc: 0.9834509225118618, new node val auc: 0.9801861680327868
2024-06-02 20:11:26,269 - root - INFO - val ap: 0.9844094041144936, new node val ap: 0.9818964876729489
2024-06-02 20:11:26,334 - root - INFO - start 17 epoch
2024-06-02 20:12:17,066 - root - INFO - epoch: 17 took 50.77s
2024-06-02 20:12:17,066 - root - INFO - Epoch mean loss: 0.3119956485449974
2024-06-02 20:12:17,066 - root - INFO - val auc: 0.9843155857581128, new node val auc: 0.9805452868852459
2024-06-02 20:12:17,067 - root - INFO - val ap: 0.9851444927632859, new node val ap: 0.9821483330559159
2024-06-02 20:12:17,130 - root - INFO - start 18 epoch
2024-06-02 20:13:07,859 - root - INFO - epoch: 18 took 50.77s
2024-06-02 20:13:07,860 - root - INFO - Epoch mean loss: 0.30853067055858413
2024-06-02 20:13:07,860 - root - INFO - val auc: 0.9846824548867167, new node val auc: 0.9813444672131147
2024-06-02 20:13:07,860 - root - INFO - val ap: 0.9853086483187447, new node val ap: 0.9829176807871608
2024-06-02 20:13:07,962 - root - INFO - start 19 epoch
2024-06-02 20:13:59,692 - root - INFO - epoch: 19 took 51.81s
2024-06-02 20:13:59,692 - root - INFO - Epoch mean loss: 0.3029239544911044
2024-06-02 20:13:59,692 - root - INFO - val auc: 0.9845311548428893, new node val auc: 0.9810075819672129
2024-06-02 20:13:59,692 - root - INFO - val ap: 0.9854885594370981, new node val ap: 0.9824993203747159
2024-06-02 20:13:59,757 - root - INFO - start 20 epoch
2024-06-02 20:14:50,044 - root - INFO - epoch: 20 took 50.33s
2024-06-02 20:14:50,044 - root - INFO - Epoch mean loss: 0.3033298838314752
2024-06-02 20:14:50,045 - root - INFO - val auc: 0.9848356456868463, new node val auc: 0.981398155737705
2024-06-02 20:14:50,045 - root - INFO - val ap: 0.9854250601624436, new node val ap: 0.9830247079861276
2024-06-02 20:14:50,108 - root - INFO - start 21 epoch
2024-06-02 20:15:40,676 - root - INFO - epoch: 21 took 50.61s
2024-06-02 20:15:40,676 - root - INFO - Epoch mean loss: 0.29871937175616253
2024-06-02 20:15:40,676 - root - INFO - val auc: 0.9849861511271175, new node val auc: 0.9810113729508197
2024-06-02 20:15:40,676 - root - INFO - val ap: 0.9856677598126153, new node val ap: 0.9827330971540341
2024-06-02 20:15:40,760 - root - INFO - start 22 epoch
2024-06-02 20:16:31,140 - root - INFO - epoch: 22 took 50.44s
2024-06-02 20:16:31,140 - root - INFO - Epoch mean loss: 0.299276860017935
2024-06-02 20:16:31,140 - root - INFO - val auc: 0.9851206277749195, new node val auc: 0.9814651639344263
2024-06-02 20:16:31,140 - root - INFO - val ap: 0.9859624105395887, new node val ap: 0.982881056020529
2024-06-02 20:16:31,207 - root - INFO - start 23 epoch
2024-06-02 20:17:21,157 - root - INFO - epoch: 23 took 49.99s
2024-06-02 20:17:21,157 - root - INFO - Epoch mean loss: 0.29147940712609316
2024-06-02 20:17:21,157 - root - INFO - val auc: 0.9849747441833877, new node val auc: 0.9805982581967213
2024-06-02 20:17:21,157 - root - INFO - val ap: 0.9858727538251216, new node val ap: 0.982239962021477
2024-06-02 20:17:21,220 - root - INFO - start 24 epoch
2024-06-02 20:18:09,824 - root - INFO - epoch: 24 took 48.64s
2024-06-02 20:18:09,824 - root - INFO - Epoch mean loss: 0.2962316947030316
2024-06-02 20:18:09,824 - root - INFO - val auc: 0.9852076878370396, new node val auc: 0.9809464139344262
2024-06-02 20:18:09,824 - root - INFO - val ap: 0.9858790008218898, new node val ap: 0.9824434176096092
2024-06-02 20:18:09,887 - root - INFO - start 25 epoch
2024-06-02 20:19:00,935 - root - INFO - epoch: 25 took 51.09s
2024-06-02 20:19:00,935 - root - INFO - Epoch mean loss: 0.2873102715009539
2024-06-02 20:19:00,935 - root - INFO - val auc: 0.985785458469102, new node val auc: 0.9816348360655738
2024-06-02 20:19:00,935 - root - INFO - val ap: 0.9864438904019117, new node val ap: 0.9830900348346322
2024-06-02 20:19:01,000 - root - INFO - start 26 epoch
2024-06-02 20:19:52,870 - root - INFO - epoch: 26 took 51.91s
2024-06-02 20:19:52,871 - root - INFO - Epoch mean loss: 0.28392429657170337
2024-06-02 20:19:52,871 - root - INFO - val auc: 0.9860713828388498, new node val auc: 0.9829417008196722
2024-06-02 20:19:52,871 - root - INFO - val ap: 0.986767239060343, new node val ap: 0.9841684230710787
2024-06-02 20:19:52,936 - root - INFO - start 27 epoch
2024-06-02 20:20:43,257 - root - INFO - epoch: 27 took 50.36s
2024-06-02 20:20:43,257 - root - INFO - Epoch mean loss: 0.283527888724663
2024-06-02 20:20:43,257 - root - INFO - val auc: 0.985707579698546, new node val auc: 0.9824065573770491
2024-06-02 20:20:43,257 - root - INFO - val ap: 0.9865168837416778, new node val ap: 0.9838451027183818
2024-06-02 20:20:43,320 - root - INFO - start 28 epoch
2024-06-02 20:21:32,885 - root - INFO - epoch: 28 took 49.61s
2024-06-02 20:21:32,886 - root - INFO - Epoch mean loss: 0.28273058576243265
2024-06-02 20:21:32,886 - root - INFO - val auc: 0.9857589650145774, new node val auc: 0.9825564549180329
2024-06-02 20:21:32,886 - root - INFO - val ap: 0.986528361130269, new node val ap: 0.9839574802023577
2024-06-02 20:21:32,950 - root - INFO - start 29 epoch
2024-06-02 20:22:22,826 - root - INFO - epoch: 29 took 49.92s
2024-06-02 20:22:22,827 - root - INFO - Epoch mean loss: 0.27726560757665214
2024-06-02 20:22:22,827 - root - INFO - val auc: 0.9851903132681644, new node val auc: 0.9811570696721312
2024-06-02 20:22:22,827 - root - INFO - val ap: 0.9859559561355933, new node val ap: 0.9825781603608356
2024-06-02 20:22:22,917 - root - INFO - start 30 epoch
2024-06-02 20:23:13,250 - root - INFO - epoch: 30 took 50.40s
2024-06-02 20:23:13,250 - root - INFO - Epoch mean loss: 0.2813706975338494
2024-06-02 20:23:13,250 - root - INFO - val auc: 0.9856839878808665, new node val auc: 0.9818969262295082
2024-06-02 20:23:13,250 - root - INFO - val ap: 0.9863531743624953, new node val ap: 0.9834708891919217
2024-06-02 20:23:13,315 - root - INFO - start 31 epoch
2024-06-02 20:24:05,738 - root - INFO - epoch: 31 took 52.47s
2024-06-02 20:24:05,739 - root - INFO - Epoch mean loss: 0.2755297698777885
2024-06-02 20:24:05,739 - root - INFO - val auc: 0.9858411078717201, new node val auc: 0.9820943647540983
2024-06-02 20:24:05,739 - root - INFO - val ap: 0.9865567618026885, new node val ap: 0.9831449956385463
2024-06-02 20:24:05,739 - root - INFO - No improvement over 5 epochs, stop training
2024-06-02 20:24:05,739 - root - INFO - Loading the best model at epoch 26
2024-06-02 20:24:05,752 - root - INFO - Loaded the best model at epoch 26 for inference
2024-06-02 20:24:20,215 - root - INFO - Test statistics: Old nodes -- auc: 0.9829754597076927, ap: 0.9837722109589421
2024-06-02 20:24:20,216 - root - INFO - Test statistics: New nodes -- auc: 0.9765962533241486, ap: 0.9773640571167846
2024-06-02 20:24:20,216 - root - INFO - Saving TGN model
2024-06-02 20:24:20,499 - root - INFO - TGN model saved
2024-06-02 20:24:20,676 - root - INFO - num of training instances: 81029
2024-06-02 20:24:20,677 - root - INFO - num of batches per epoch: 406
2024-06-02 20:24:20,679 - root - INFO - start 0 epoch
2024-06-02 20:25:05,612 - root - INFO - epoch: 0 took 44.93s
2024-06-02 20:25:05,612 - root - INFO - Epoch mean loss: 0.6928560415952664
2024-06-02 20:25:05,612 - root - INFO - val auc: 0.9484948831913717, new node val auc: 0.9526647540983607
2024-06-02 20:25:05,612 - root - INFO - val ap: 0.9498184567902669, new node val ap: 0.9545475877623452
2024-06-02 20:25:05,677 - root - INFO - start 1 epoch
2024-06-02 20:25:56,399 - root - INFO - epoch: 1 took 50.76s
2024-06-02 20:25:56,400 - root - INFO - Epoch mean loss: 0.5430354722614946
2024-06-02 20:25:56,400 - root - INFO - val auc: 0.9600995445797367, new node val auc: 0.9618843237704916
2024-06-02 20:25:56,400 - root - INFO - val ap: 0.9629076103345533, new node val ap: 0.9642240568123749
2024-06-02 20:25:56,487 - root - INFO - start 2 epoch
2024-06-02 20:26:46,737 - root - INFO - epoch: 2 took 50.31s
2024-06-02 20:26:46,737 - root - INFO - Epoch mean loss: 0.49481986213493817
2024-06-02 20:26:46,737 - root - INFO - val auc: 0.9587202285676176, new node val auc: 0.9579293032786886
2024-06-02 20:26:46,737 - root - INFO - val ap: 0.961139661822777, new node val ap: 0.9608345693475291
2024-06-02 20:26:46,801 - root - INFO - start 3 epoch
2024-06-02 20:27:36,406 - root - INFO - epoch: 3 took 49.65s
2024-06-02 20:27:36,406 - root - INFO - Epoch mean loss: 0.4662934570330117
2024-06-02 20:27:36,406 - root - INFO - val auc: 0.9667393190609578, new node val auc: 0.9632957991803278
2024-06-02 20:27:36,406 - root - INFO - val ap: 0.968768688119198, new node val ap: 0.96582707544287
2024-06-02 20:27:36,469 - root - INFO - start 4 epoch
2024-06-02 20:28:27,517 - root - INFO - epoch: 4 took 51.09s
2024-06-02 20:28:27,517 - root - INFO - Epoch mean loss: 0.43704069688402375
2024-06-02 20:28:27,518 - root - INFO - val auc: 0.9704068870405305, new node val auc: 0.9663858606557377
2024-06-02 20:28:27,518 - root - INFO - val ap: 0.9717729410068823, new node val ap: 0.9688638531565515
2024-06-02 20:28:27,609 - root - INFO - start 5 epoch
2024-06-02 20:29:19,655 - root - INFO - epoch: 5 took 52.12s
2024-06-02 20:29:19,656 - root - INFO - Epoch mean loss: 0.4268564843558913
2024-06-02 20:29:19,656 - root - INFO - val auc: 0.972522302254235, new node val auc: 0.9700967213114755
2024-06-02 20:29:19,656 - root - INFO - val ap: 0.9735734979427236, new node val ap: 0.9718785079072415
2024-06-02 20:29:19,721 - root - INFO - start 6 epoch
2024-06-02 20:30:11,627 - root - INFO - epoch: 6 took 51.95s
2024-06-02 20:30:11,627 - root - INFO - Epoch mean loss: 0.40536902125539453
2024-06-02 20:30:11,628 - root - INFO - val auc: 0.9733855832809315, new node val auc: 0.9694522540983608
2024-06-02 20:30:11,628 - root - INFO - val ap: 0.9745504383028499, new node val ap: 0.9713412941119878
2024-06-02 20:30:11,694 - root - INFO - start 7 epoch
2024-06-02 20:31:04,384 - root - INFO - epoch: 7 took 52.73s
2024-06-02 20:31:04,384 - root - INFO - Epoch mean loss: 0.39196905622194556
2024-06-02 20:31:04,384 - root - INFO - val auc: 0.9750683168505497, new node val auc: 0.9711944672131148
2024-06-02 20:31:04,384 - root - INFO - val ap: 0.9764321175574325, new node val ap: 0.9734838551510755
2024-06-02 20:31:04,448 - root - INFO - start 8 epoch
2024-06-02 20:31:55,035 - root - INFO - epoch: 8 took 50.63s
2024-06-02 20:31:55,035 - root - INFO - Epoch mean loss: 0.38304212344397465
2024-06-02 20:31:55,035 - root - INFO - val auc: 0.9783786733741117, new node val auc: 0.9758389344262295
2024-06-02 20:31:55,035 - root - INFO - val ap: 0.9799168059659834, new node val ap: 0.9779981316012937
2024-06-02 20:31:55,101 - root - INFO - start 9 epoch
2024-06-02 20:32:45,933 - root - INFO - epoch: 9 took 50.87s
2024-06-02 20:32:45,934 - root - INFO - Epoch mean loss: 0.35743001551170067
2024-06-02 20:32:45,934 - root - INFO - val auc: 0.9820639279521334, new node val auc: 0.9789821721311476
2024-06-02 20:32:45,934 - root - INFO - val ap: 0.9831257716079425, new node val ap: 0.9807583728356872
2024-06-02 20:32:45,998 - root - INFO - start 10 epoch
2024-06-02 20:33:35,748 - root - INFO - epoch: 10 took 49.79s
2024-06-02 20:33:35,749 - root - INFO - Epoch mean loss: 0.33993768449780976
2024-06-02 20:33:35,749 - root - INFO - val auc: 0.9822151884563348, new node val auc: 0.978491905737705
2024-06-02 20:33:35,749 - root - INFO - val ap: 0.9833591120423179, new node val ap: 0.9803299878387142
2024-06-02 20:33:35,815 - root - INFO - start 11 epoch
2024-06-02 20:34:25,147 - root - INFO - epoch: 11 took 49.37s
2024-06-02 20:34:25,147 - root - INFO - Epoch mean loss: 0.3370613697273978
2024-06-02 20:34:25,147 - root - INFO - val auc: 0.9826091584252751, new node val auc: 0.9798956967213116
2024-06-02 20:34:25,147 - root - INFO - val ap: 0.9836955821458052, new node val ap: 0.9813960685739592
2024-06-02 20:34:25,211 - root - INFO - start 12 epoch
2024-06-02 20:35:15,241 - root - INFO - epoch: 12 took 50.07s
2024-06-02 20:35:15,241 - root - INFO - Epoch mean loss: 0.3306443159803381
2024-06-02 20:35:15,242 - root - INFO - val auc: 0.9826634225118618, new node val auc: 0.979548155737705
2024-06-02 20:35:15,242 - root - INFO - val ap: 0.9837556898754712, new node val ap: 0.9813556787811055
2024-06-02 20:35:15,323 - root - INFO - start 13 epoch
2024-06-02 20:36:09,220 - root - INFO - epoch: 13 took 53.96s
2024-06-02 20:36:09,220 - root - INFO - Epoch mean loss: 0.32886340138800624
2024-06-02 20:36:09,220 - root - INFO - val auc: 0.9838345785933421, new node val auc: 0.9797862704918032
2024-06-02 20:36:09,220 - root - INFO - val ap: 0.9847113289300938, new node val ap: 0.9815218105665646
2024-06-02 20:36:09,300 - root - INFO - start 14 epoch
2024-06-02 20:37:02,182 - root - INFO - epoch: 14 took 52.94s
2024-06-02 20:37:02,182 - root - INFO - Epoch mean loss: 0.31982824690823486
2024-06-02 20:37:02,182 - root - INFO - val auc: 0.9829782136664189, new node val auc: 0.9792917008196723
2024-06-02 20:37:02,182 - root - INFO - val ap: 0.9837996948136196, new node val ap: 0.980820688403384
2024-06-02 20:37:02,247 - root - INFO - start 15 epoch
2024-06-02 20:37:53,346 - root - INFO - epoch: 15 took 51.14s
2024-06-02 20:37:53,346 - root - INFO - Epoch mean loss: 0.3179403388221276
2024-06-02 20:37:53,346 - root - INFO - val auc: 0.9842861115874922, new node val auc: 0.9809459016393443
2024-06-02 20:37:53,346 - root - INFO - val ap: 0.9852492636569202, new node val ap: 0.9826036974937831
2024-06-02 20:37:53,411 - root - INFO - start 16 epoch
2024-06-02 20:38:44,612 - root - INFO - epoch: 16 took 51.24s
2024-06-02 20:38:44,612 - root - INFO - Epoch mean loss: 0.3168216959155839
2024-06-02 20:38:44,612 - root - INFO - val auc: 0.9841916590445703, new node val auc: 0.9806057377049181
2024-06-02 20:38:44,612 - root - INFO - val ap: 0.9851274537895408, new node val ap: 0.9822442562541178
2024-06-02 20:38:44,679 - root - INFO - start 17 epoch
2024-06-02 20:39:37,492 - root - INFO - epoch: 17 took 52.86s
2024-06-02 20:39:37,492 - root - INFO - Epoch mean loss: 0.3111199229001412
2024-06-02 20:39:37,492 - root - INFO - val auc: 0.9842408187084357, new node val auc: 0.980567213114754
2024-06-02 20:39:37,492 - root - INFO - val ap: 0.9850930240022135, new node val ap: 0.9820348430793331
2024-06-02 20:39:37,561 - root - INFO - start 18 epoch
2024-06-02 20:40:27,323 - root - INFO - epoch: 18 took 49.81s
2024-06-02 20:40:27,323 - root - INFO - Epoch mean loss: 0.3070600628852844
2024-06-02 20:40:27,323 - root - INFO - val auc: 0.9834441509937306, new node val auc: 0.9808474385245901
2024-06-02 20:40:27,323 - root - INFO - val ap: 0.9839668142225092, new node val ap: 0.9823204728957462
2024-06-02 20:40:27,386 - root - INFO - start 19 epoch
2024-06-02 20:41:17,480 - root - INFO - epoch: 19 took 50.13s
2024-06-02 20:41:17,480 - root - INFO - Epoch mean loss: 0.30124533826054023
2024-06-02 20:41:17,480 - root - INFO - val auc: 0.9843370371958308, new node val auc: 0.9805191598360655
2024-06-02 20:41:17,481 - root - INFO - val ap: 0.9852803275630806, new node val ap: 0.982148807204222
2024-06-02 20:41:17,544 - root - INFO - start 20 epoch
2024-06-02 20:42:07,567 - root - INFO - epoch: 20 took 50.06s
2024-06-02 20:42:07,567 - root - INFO - Epoch mean loss: 0.30210408373859715
2024-06-02 20:42:07,567 - root - INFO - val auc: 0.9840084657672593, new node val auc: 0.980276331967213
2024-06-02 20:42:07,567 - root - INFO - val ap: 0.9847601323728911, new node val ap: 0.9816386902387483
2024-06-02 20:42:07,630 - root - INFO - start 21 epoch
2024-06-02 20:42:56,830 - root - INFO - epoch: 21 took 49.24s
2024-06-02 20:42:56,831 - root - INFO - Epoch mean loss: 0.3009007238769179
2024-06-02 20:42:56,831 - root - INFO - val auc: 0.9853651655900457, new node val auc: 0.9817045081967212
2024-06-02 20:42:56,831 - root - INFO - val ap: 0.9860998755056548, new node val ap: 0.9829984551434934
2024-06-02 20:42:56,895 - root - INFO - start 22 epoch
2024-06-02 20:43:46,530 - root - INFO - epoch: 22 took 49.68s
2024-06-02 20:43:46,531 - root - INFO - Epoch mean loss: 0.29814324619734817
2024-06-02 20:43:46,531 - root - INFO - val auc: 0.9846557742144477, new node val auc: 0.9816075819672131
2024-06-02 20:43:46,531 - root - INFO - val ap: 0.9856269835839092, new node val ap: 0.9832378209574409
2024-06-02 20:43:46,595 - root - INFO - start 23 epoch
2024-06-02 20:44:36,781 - root - INFO - epoch: 23 took 50.23s
2024-06-02 20:44:36,782 - root - INFO - Epoch mean loss: 0.29437246984742543
2024-06-02 20:44:36,782 - root - INFO - val auc: 0.9847034237504526, new node val auc: 0.980795286885246
2024-06-02 20:44:36,782 - root - INFO - val ap: 0.9854159358726545, new node val ap: 0.9822797231272715
2024-06-02 20:44:36,852 - root - INFO - start 24 epoch
2024-06-02 20:45:26,478 - root - INFO - epoch: 24 took 49.67s
2024-06-02 20:45:26,478 - root - INFO - Epoch mean loss: 0.2917653722092142
2024-06-02 20:45:26,478 - root - INFO - val auc: 0.9851268907563026, new node val auc: 0.9818078893442623
2024-06-02 20:45:26,478 - root - INFO - val ap: 0.9856780176157237, new node val ap: 0.9832781547463975
2024-06-02 20:45:26,543 - root - INFO - start 25 epoch
2024-06-02 20:46:16,444 - root - INFO - epoch: 25 took 49.94s
2024-06-02 20:46:16,444 - root - INFO - Epoch mean loss: 0.2903314679310533
2024-06-02 20:46:16,444 - root - INFO - val auc: 0.9855545365765354, new node val auc: 0.9823674180327868
2024-06-02 20:46:16,444 - root - INFO - val ap: 0.9861258961420998, new node val ap: 0.9837356484528195
2024-06-02 20:46:16,508 - root - INFO - start 26 epoch
2024-06-02 20:47:06,170 - root - INFO - epoch: 26 took 49.70s
2024-06-02 20:47:06,171 - root - INFO - Epoch mean loss: 0.2881337338370349
2024-06-02 20:47:06,171 - root - INFO - val auc: 0.9853970754968655, new node val auc: 0.9827657786885245
2024-06-02 20:47:06,171 - root - INFO - val ap: 0.9862206622858598, new node val ap: 0.9842517559745846
2024-06-02 20:47:06,235 - root - INFO - start 27 epoch
2024-06-02 20:47:55,342 - root - INFO - epoch: 27 took 49.15s
2024-06-02 20:47:55,342 - root - INFO - Epoch mean loss: 0.2831871197398367
2024-06-02 20:47:55,342 - root - INFO - val auc: 0.985675249623659, new node val auc: 0.9825036885245901
2024-06-02 20:47:55,342 - root - INFO - val ap: 0.9862846462654512, new node val ap: 0.9838192845384236
2024-06-02 20:47:55,443 - root - INFO - start 28 epoch
2024-06-02 20:48:45,777 - root - INFO - epoch: 28 took 50.41s
2024-06-02 20:48:45,777 - root - INFO - Epoch mean loss: 0.2840644475531402
2024-06-02 20:48:45,777 - root - INFO - val auc: 0.9847501872177442, new node val auc: 0.9817321721311476
2024-06-02 20:48:45,777 - root - INFO - val ap: 0.9855295955331421, new node val ap: 0.9833006088954245
2024-06-02 20:48:45,842 - root - INFO - start 29 epoch
2024-06-02 20:49:36,204 - root - INFO - epoch: 29 took 50.40s
2024-06-02 20:49:36,204 - root - INFO - Epoch mean loss: 0.2846280389598438
2024-06-02 20:49:36,205 - root - INFO - val auc: 0.9853178966824825, new node val auc: 0.9829804303278689
2024-06-02 20:49:36,205 - root - INFO - val ap: 0.9858687456972975, new node val ap: 0.9841933374054898
2024-06-02 20:49:36,325 - root - INFO - start 30 epoch
2024-06-02 20:50:28,663 - root - INFO - epoch: 30 took 52.42s
2024-06-02 20:50:28,664 - root - INFO - Epoch mean loss: 0.27869147275175365
2024-06-02 20:50:28,664 - root - INFO - val auc: 0.98474703595724, new node val auc: 0.9819503073770492
2024-06-02 20:50:28,664 - root - INFO - val ap: 0.9852702274840953, new node val ap: 0.9833111074485207
2024-06-02 20:50:28,726 - root - INFO - start 31 epoch
2024-06-02 20:51:18,844 - root - INFO - epoch: 31 took 50.16s
2024-06-02 20:51:18,845 - root - INFO - Epoch mean loss: 0.27724883191544436
2024-06-02 20:51:18,845 - root - INFO - val auc: 0.9856306494026181, new node val auc: 0.982605737704918
2024-06-02 20:51:18,845 - root - INFO - val ap: 0.9862049731879725, new node val ap: 0.9840035601894259
2024-06-02 20:51:18,908 - root - INFO - start 32 epoch
2024-06-02 20:52:10,578 - root - INFO - epoch: 32 took 51.71s
2024-06-02 20:52:10,578 - root - INFO - Epoch mean loss: 0.2730538540249094
2024-06-02 20:52:10,579 - root - INFO - val auc: 0.9846486511271175, new node val auc: 0.9818821721311474
2024-06-02 20:52:10,579 - root - INFO - val ap: 0.9851185558307318, new node val ap: 0.9832693031635673
2024-06-02 20:52:10,579 - root - INFO - No improvement over 5 epochs, stop training
2024-06-02 20:52:10,579 - root - INFO - Loading the best model at epoch 27
2024-06-02 20:52:10,591 - root - INFO - Loaded the best model at epoch 27 for inference
2024-06-02 20:52:25,036 - root - INFO - Test statistics: Old nodes -- auc: 0.9831498918615065, ap: 0.983776123351519
2024-06-02 20:52:25,037 - root - INFO - Test statistics: New nodes -- auc: 0.976295461135497, ap: 0.9771486934789263
2024-06-02 20:52:25,037 - root - INFO - Saving TGN model
2024-06-02 20:52:25,322 - root - INFO - TGN model saved
2024-06-02 20:52:25,484 - root - INFO - num of training instances: 81029
2024-06-02 20:52:25,484 - root - INFO - num of batches per epoch: 406
2024-06-02 20:52:25,487 - root - INFO - start 0 epoch
2024-06-02 20:53:11,329 - root - INFO - epoch: 0 took 45.84s
2024-06-02 20:53:11,330 - root - INFO - Epoch mean loss: 0.7234204940020744
2024-06-02 20:53:11,330 - root - INFO - val auc: 0.9321082278149357, new node val auc: 0.9334308401639343
2024-06-02 20:53:11,330 - root - INFO - val ap: 0.9357008874294515, new node val ap: 0.9383512093880799
2024-06-02 20:53:11,413 - root - INFO - start 1 epoch
2024-06-02 20:54:02,288 - root - INFO - epoch: 1 took 50.93s
2024-06-02 20:54:02,289 - root - INFO - Epoch mean loss: 0.5576124073102556
2024-06-02 20:54:02,289 - root - INFO - val auc: 0.9560506240591475, new node val auc: 0.9536715163934425
2024-06-02 20:54:02,289 - root - INFO - val ap: 0.959300618436761, new node val ap: 0.9564485129404576
2024-06-02 20:54:02,370 - root - INFO - start 2 epoch
2024-06-02 20:54:53,441 - root - INFO - epoch: 2 took 51.13s
2024-06-02 20:54:53,441 - root - INFO - Epoch mean loss: 0.49365811013235833
2024-06-02 20:54:53,441 - root - INFO - val auc: 0.9635939440061739, new node val auc: 0.9610231557377049
2024-06-02 20:54:53,441 - root - INFO - val ap: 0.9660538242899852, new node val ap: 0.96378761227347
2024-06-02 20:54:53,531 - root - INFO - start 3 epoch
2024-06-02 20:55:48,211 - root - INFO - epoch: 3 took 54.75s
2024-06-02 20:55:48,211 - root - INFO - Epoch mean loss: 0.4526562230487175
2024-06-02 20:55:48,212 - root - INFO - val auc: 0.9658660850054308, new node val auc: 0.9646218237704918
2024-06-02 20:55:48,212 - root - INFO - val ap: 0.9676507077923396, new node val ap: 0.9665595014687159
2024-06-02 20:55:48,274 - root - INFO - start 4 epoch
2024-06-02 20:56:41,381 - root - INFO - epoch: 4 took 53.15s
2024-06-02 20:56:41,381 - root - INFO - Epoch mean loss: 0.4305629150327203
2024-06-02 20:56:41,381 - root - INFO - val auc: 0.9716584991139312, new node val auc: 0.9682391393442622
2024-06-02 20:56:41,381 - root - INFO - val ap: 0.9730570098514879, new node val ap: 0.9700574263184926
2024-06-02 20:56:41,483 - root - INFO - start 5 epoch
2024-06-02 20:57:30,316 - root - INFO - epoch: 5 took 48.91s
2024-06-02 20:57:30,317 - root - INFO - Epoch mean loss: 0.41986495851002303
2024-06-02 20:57:30,317 - root - INFO - val auc: 0.9723166133119914, new node val auc: 0.9705627049180329
2024-06-02 20:57:30,317 - root - INFO - val ap: 0.9736323302077787, new node val ap: 0.9730694863270344
2024-06-02 20:57:30,379 - root - INFO - start 6 epoch
2024-06-02 20:58:19,382 - root - INFO - epoch: 6 took 49.04s
2024-06-02 20:58:19,382 - root - INFO - Epoch mean loss: 0.40619101301936683
2024-06-02 20:58:19,383 - root - INFO - val auc: 0.9727985856247262, new node val auc: 0.9701450819672132
2024-06-02 20:58:19,383 - root - INFO - val ap: 0.9742307225465151, new node val ap: 0.9719460206658762
2024-06-02 20:58:19,445 - root - INFO - start 7 epoch
2024-06-02 20:59:09,863 - root - INFO - epoch: 7 took 50.46s
2024-06-02 20:59:09,864 - root - INFO - Epoch mean loss: 0.3977864771861161
2024-06-02 20:59:09,864 - root - INFO - val auc: 0.9745410059261801, new node val auc: 0.9698241803278688
2024-06-02 20:59:09,864 - root - INFO - val ap: 0.9758449773055125, new node val ap: 0.9719196636959924
2024-06-02 20:59:09,929 - root - INFO - start 8 epoch
2024-06-02 20:59:59,345 - root - INFO - epoch: 8 took 49.46s
2024-06-02 20:59:59,346 - root - INFO - Epoch mean loss: 0.3860976862643153
2024-06-02 20:59:59,346 - root - INFO - val auc: 0.9758546385220755, new node val auc: 0.9734956967213116
2024-06-02 20:59:59,346 - root - INFO - val ap: 0.9773607157109143, new node val ap: 0.9753066052725209
2024-06-02 20:59:59,410 - root - INFO - start 9 epoch
2024-06-02 21:00:48,447 - root - INFO - epoch: 9 took 49.08s
2024-06-02 21:00:48,447 - root - INFO - Epoch mean loss: 0.37261338084202095
2024-06-02 21:00:48,447 - root - INFO - val auc: 0.9781611511271174, new node val auc: 0.9739924180327868
2024-06-02 21:00:48,447 - root - INFO - val ap: 0.9793203188842906, new node val ap: 0.9759630432765228
2024-06-02 21:00:48,510 - root - INFO - start 10 epoch
2024-06-02 21:01:38,306 - root - INFO - epoch: 10 took 49.84s
2024-06-02 21:01:38,307 - root - INFO - Epoch mean loss: 0.35256288982377265
2024-06-02 21:01:38,307 - root - INFO - val auc: 0.9803650345852628, new node val auc: 0.9776743852459017
2024-06-02 21:01:38,307 - root - INFO - val ap: 0.9814091097167318, new node val ap: 0.9796375287803247
2024-06-02 21:01:38,372 - root - INFO - start 11 epoch
2024-06-02 21:02:29,584 - root - INFO - epoch: 11 took 51.25s
2024-06-02 21:02:29,584 - root - INFO - Epoch mean loss: 0.346092981914875
2024-06-02 21:02:29,584 - root - INFO - val auc: 0.9817947417062064, new node val auc: 0.9793813524590164
2024-06-02 21:02:29,584 - root - INFO - val ap: 0.9828342796197285, new node val ap: 0.9809573129606263
2024-06-02 21:02:29,649 - root - INFO - start 12 epoch
2024-06-02 21:03:20,676 - root - INFO - epoch: 12 took 51.07s
2024-06-02 21:03:20,676 - root - INFO - Epoch mean loss: 0.3367874275507598
2024-06-02 21:03:20,676 - root - INFO - val auc: 0.9818537357800263, new node val auc: 0.9790556352459017
2024-06-02 21:03:20,676 - root - INFO - val ap: 0.98270259416013, new node val ap: 0.9806448195759674
2024-06-02 21:03:20,738 - root - INFO - start 13 epoch
2024-06-02 21:04:12,094 - root - INFO - epoch: 13 took 51.40s
2024-06-02 21:04:12,094 - root - INFO - Epoch mean loss: 0.33048357175929205
2024-06-02 21:04:12,095 - root - INFO - val auc: 0.9831607309590503, new node val auc: 0.9801436475409837
2024-06-02 21:04:12,095 - root - INFO - val ap: 0.9841476979013071, new node val ap: 0.9817221576702508
2024-06-02 21:04:12,161 - root - INFO - start 14 epoch
2024-06-02 21:05:05,094 - root - INFO - epoch: 14 took 52.98s
2024-06-02 21:05:05,094 - root - INFO - Epoch mean loss: 0.31743656139215226
2024-06-02 21:05:05,094 - root - INFO - val auc: 0.9838931067665161, new node val auc: 0.981947848360656
2024-06-02 21:05:05,094 - root - INFO - val ap: 0.9846779498459012, new node val ap: 0.9834006730524111
2024-06-02 21:05:05,157 - root - INFO - start 15 epoch
2024-06-02 21:05:55,239 - root - INFO - epoch: 15 took 50.12s
2024-06-02 21:05:55,239 - root - INFO - Epoch mean loss: 0.31135383971365804
2024-06-02 21:05:55,239 - root - INFO - val auc: 0.9841376445816423, new node val auc: 0.9819725409836066
2024-06-02 21:05:55,239 - root - INFO - val ap: 0.9850690788628603, new node val ap: 0.9830320366187874
2024-06-02 21:05:55,303 - root - INFO - start 16 epoch
2024-06-02 21:06:47,426 - root - INFO - epoch: 16 took 52.16s
2024-06-02 21:06:47,426 - root - INFO - Epoch mean loss: 0.31455169687864226
2024-06-02 21:06:47,426 - root - INFO - val auc: 0.98333354484651, new node val auc: 0.9805798155737705
2024-06-02 21:06:47,426 - root - INFO - val ap: 0.9843223655161358, new node val ap: 0.9822709758786803
2024-06-02 21:06:47,492 - root - INFO - start 17 epoch
2024-06-02 21:07:37,581 - root - INFO - epoch: 17 took 50.13s
2024-06-02 21:07:37,581 - root - INFO - Epoch mean loss: 0.3156522458483433
2024-06-02 21:07:37,581 - root - INFO - val auc: 0.9827739891194572, new node val auc: 0.9799306352459016
2024-06-02 21:07:37,581 - root - INFO - val ap: 0.9834728092768318, new node val ap: 0.9813957703190889
2024-06-02 21:07:37,645 - root - INFO - start 18 epoch
2024-06-02 21:08:30,518 - root - INFO - epoch: 18 took 52.92s
2024-06-02 21:08:30,518 - root - INFO - Epoch mean loss: 0.3116402021549605
2024-06-02 21:08:30,519 - root - INFO - val auc: 0.9825368209188438, new node val auc: 0.9795411885245902
2024-06-02 21:08:30,519 - root - INFO - val ap: 0.9830823870704793, new node val ap: 0.9812222526938544
2024-06-02 21:08:30,609 - root - INFO - start 19 epoch
2024-06-02 21:09:20,703 - root - INFO - epoch: 19 took 50.16s
2024-06-02 21:09:20,703 - root - INFO - Epoch mean loss: 0.30820221697975847
2024-06-02 21:09:20,703 - root - INFO - val auc: 0.9842274357361993, new node val auc: 0.9812928278688526
2024-06-02 21:09:20,703 - root - INFO - val ap: 0.9848351522609817, new node val ap: 0.9826792895516121
2024-06-02 21:09:20,767 - root - INFO - start 20 epoch
2024-06-02 21:10:10,478 - root - INFO - epoch: 20 took 49.75s
2024-06-02 21:10:10,478 - root - INFO - Epoch mean loss: 0.3058538944116367
2024-06-02 21:10:10,479 - root - INFO - val auc: 0.984175482573982, new node val auc: 0.981501844262295
2024-06-02 21:10:10,479 - root - INFO - val ap: 0.9850078730004963, new node val ap: 0.9824106792089344
2024-06-02 21:10:10,479 - root - INFO - No improvement over 5 epochs, stop training
2024-06-02 21:10:10,479 - root - INFO - Loading the best model at epoch 15
2024-06-02 21:10:10,491 - root - INFO - Loaded the best model at epoch 15 for inference
2024-06-02 21:10:24,938 - root - INFO - Test statistics: Old nodes -- auc: 0.9812898078278931, ap: 0.982384301208312
2024-06-02 21:10:24,938 - root - INFO - Test statistics: New nodes -- auc: 0.9744872164461248, ap: 0.9753279388667906
2024-06-02 21:10:24,938 - root - INFO - Saving TGN model
2024-06-02 21:10:25,223 - root - INFO - TGN model saved
